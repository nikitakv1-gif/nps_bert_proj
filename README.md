## Проект для Samsung innovation campus
Проект выполнили **Багрова Ксения** и **Квернадзе Никита**. Студенты РТУ МИРЭА, ИТУ, УСБО-01-22

Основной задачей данного проекта было создание и обучение модели, способной предсказывать NPS скор отзыва и рассчитывать общий NPS по пакету отзывов

Ноутбук с кодом обучения модели, находится в model/presave/review-classigfication.ipynb, а также на [Kaggle](https://www.kaggle.com/code/nizenkiy/review-classigfication)

Для удобства работы с моделью, был написан простой веб интерфейс. Он позволяет загрузить в модель файл и получить NPS скор по отзывам и диаграмму распределения отзывов по NPS оценкам. 


### Краткое описание работы алгоритма

В связи с тем, что размеченных данных по NPS оценкам найдено не было, использовался расчетный метод оценки NPS для каждого отзыва. 

#### 1. Этап. Оценка звездности отзыва

Для обучения использовали отзывы состоящие из трех частей. Перва часть - общий текст, вторая - плюсы, третья - минусы. 
Для анализа каждой части использовался трансформер rubert-tiny2. В итоге три трансформера с общей памятию исследовали каждую часть отзыва и на основе их оценок использовалась линейка, выдающая итоговый результат.

#### 2. Этап. Оценка эмоциональности отзыва. 
Задача данной модели, оценить насколько отзыв положительный. Что бы точнее оценивать NPS скор отзыва в последствии.
В данном случае использовалась предобученная модель "blanchefort/rubert-base-cased-sentiment", без каких-либо изменений и дообучений. 

### 3. Этап. Оценка NPS.

После первого этапа, для каждого отзыва мы сохраняем предсказанную звездность от 1 до 5
После второго этапа, мы сохраняем вероятности, после softmax преобразования. 

Перед расчетом итоговой оценки NPS. Оценки переводятся в шкалу от 0 до 1, по следующей формуле: $star-new = \frac{(star-1)}{4}$.

А на основе результатом модели по эмоциям, рассчитывается средняя метрика по формуле: $avg-emo = emo-positive - emo-negative + 0.5*emo-neutral$.

Итоговая формула для расчета NPS оценки: $nps-score = star-new * emo-avg * 10$
